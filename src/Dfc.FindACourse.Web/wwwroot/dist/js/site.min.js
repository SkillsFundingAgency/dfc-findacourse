"use strict";$(function(){var s=function(e){var o=$("#SubjectKeyword").val();$("#SubjectKeyword").focus().val("").val(o);var t=$("#course-list"),r=t.find("li.item-hover"),s=t.innerHeight(),n=t.scrollTop(),i=r.outerHeight(!0),a=r.index()+1;"down"===e&&(s<a*i&&t.scrollTop(n+i),i||t.scrollTop(0)),"up"===e&&(t.scrollTop(n-i),i||(t.scrollTop(t[0].scrollHeight),r.removeClass("item-hover"),t.find("li:last-child").addClass("item-hover")))};$("#SubjectKeyword").on("keyup",function(e){var i,o,t,r=e.keyCode||e.which;38!==r&&40!==r&&($("#course-list li").each(function(){$(this).remove()}),13!==r&&(i=$(this).val(),$.ajax({type:"GET",url:"/coursedirectory/autocomplete",contentType:"application/json; charset=utf-8",dataType:"json",data:{parm:i},success:function(e){$.each(e,function(e,o){var t=o.toLowerCase(),r=o.toUpperCase(),s="<strong>"+i.toUpperCase()+"</strong>",n="";n=-1<t.indexOf(i.toLowerCase())?r.replace(i.toUpperCase(),s):r,$("#course-list").append($("<li>",{"data-value":o,html:n}))}),0<$("#course-list").children("li").length?$("#course-list").show():$("#course-list").hide()},failure:function(e){console.log(e.responseText)},error:function(e){console.log(e.responseText)}}))),38!==r&&40!==r||(o=r,t=$("#course-list li.item-hover"),38===o&&t.length&&(t.removeClass("item-hover"),t.prev()&&t.prev().addClass("item-hover"),s("up")),40===o&&(t.length?(t.removeClass("item-hover"),t.next()&&t.next().addClass("item-hover")):$("#course-list li").first().addClass("item-hover"),s("down")))}),$("#SubjectKeyword").on("keydown",function(e){var o=e.keyCode||e.which;13===o&&$("#course-list").is(":visible")&&(e.preventDefault(),$("#course-list").trigger("click")),9===o&&$("#course-list").hide()}),$("#SubjectKeyword").on("click",function(){$("#course-list").hide()}),$(document).on("click",function(){$("#course-list").hide()}),$("#course-list").on("click",function(){var e=$("#course-list li:hover").attr("data-value"),o=$("#course-list li.item-hover").attr("data-value");o?$("#SubjectKeyword").val(o):$("#SubjectKeyword").val(e),$(this).hide(),$("#SubjectKeyword").focus()})}),$(function(){var r=function(e,o){var t=$(o).closest(".form-group");$(e).valid()?t&&t.hasClass("error")&&t.removeClass("error"):t&&(t.hasClass("error")||t.addClass("error"))};$("#FindACourseForm input:text[data-val=true]").on("focusout keyup",function(){r($("#FindACourseForm"),this)}),$("#FindACourseForm").on("submit",function(){var t=this;$("#FindACourseForm .input-validation-error").each(function(e,o){r(t,o)})})});var Dfe=Dfe||{};Dfe.FindACourse=Dfe.FindACourse||{},Dfe.FindACourse.initGoogleMapsLocationAutoComplete=function(){var r=$("#Location")[0],s=$("#LocationCoordinates"),n=new google.maps.places.Autocomplete(r);n.setComponentRestrictions({country:["uk"]}),n.setFields(["address_components","geometry","name"]),n.addListener("place_changed",function(){var e=n.getPlace();if(e.geometry){s.val(""),s.val(e.geometry.location.lat()+","+e.geometry.location.lng());var o=e.address_components.filter(function(e){return-1<$.inArray("postal_code",e.types)}),t=e.address_components.filter(function(e){return-1<$.inArray("postal_town",e.types)});o&&0<o.length?$(r).val("").val(o[0].long_name):t&&0<t.length&&$(r).val("").val(t[0].long_name)}else console.log("Error no location data returned for '"+e.name+"'")})};